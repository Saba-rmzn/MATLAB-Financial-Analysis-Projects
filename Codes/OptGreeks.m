function [ECGreeks,EPGreeks]=OptGreeks(S0,K,T,Rf,Sigma)
d1=(log(S0/K)+(Rf+.5*Sigma^2)*T)/(Sigma*sqrt(T));
d2=d1-Sigma*sqrt(T);
Nd1=normcdf(d1,0,1);
Nd2=normcdf(d2,0,1);
Npd1=normpdf(d1,0,1);
Npmd1=normpdf(-d1,0,1);
Nmd2=normcdf(-d2,0,1);
CallDelta=Nd1;
PutDelta=Nd1-1;
CallGamma=Npd1/(Sigma*S0*sqrt(T));
PutGamma=Npd1/(Sigma*S0*sqrt(T));
CallTheta=-((Sigma*S0*Npd1)/(2*sqrt(T)))-Rf*K*exp(-Rf*T)*Nd2;
PutTheta=-((Sigma*S0*Npmd1)/(2*sqrt(T)))+Rf*K*exp(-Rf*T)*Nmd2;
CallVega=S0*sqrt(T)*Npd1;
PutVega=S0*sqrt(T)*Npd1;
CallRho=K*T*exp(-Rf*T)*Nd2;
PutRho=-K*T*exp(-Rf*T)*Nmd2;
ECGreeks=[CallDelta,CallGamma,CallTheta,CallVega,CallRho]';
EPGreeks=[PutDelta,PutGamma,PutTheta,PutVega,PutRho]';